version: "3.1"

rules:

- rule: GREET USER
  steps:
  - intent: user_greet
  - action: utter_greet

- rule: activate SUBJECT_WITH_TOPIC_FORM
  steps:
  - intent: ask_for_suggestion
  - action: action_clean_entity
  - action: subject_with_topic_form
  - active_loop: subject_with_topic_form
  - active_loop: null
  - action: questions_form
  - active_loop: questions_form
  - active_loop: null
  - action: utter_done

- rule: GET USER FEEDBACK RULE
  steps:
  - intent: user_feedback
  - action: action_clean_feedbackform_slots
  - action: feedback_form
  - active_loop: feedback_form
  - active_loop: null
  - action: utter_thanks_feedback

- rule: save user data
  steps:
  - intent: user_data
  - action: action_save_data

- rule: out of scope
  steps:
  - intent: out_of_scope
  - action: utter_default

- rule: user bot challenge
  steps:
  - intent: bot_challenge
  - action: utter_i_am_a_bot

- rule: ask user to rephrase
  steps:
  - intent: nlu_fallback
  - action: utter_rephrase

- rule: remind call
  steps:
  - intent: ask_remind_call
  - action: action_set_reminder
  # - action: action_clean_time_slot

- rule: forget reminder
  steps:
  - intent: ask_forget_reminders
  - action: action_forget_reminders

- rule: say goodbye to user
  steps:
  - intent: user_goodbye
  - action: utter_goodbye

- rule: react to reminder
  steps:
  - intent: EXTERNAL_reminder
  - action: action_react_to_reminder

- rule: say thanks to user
  steps:
  - intent: user_thanks
  - action: utter_welcome

# - rule: explain question types available
#   steps:
#   - intent: ask_question_types
#   - action: action_explain_question_types
#   - action: action_explain_question_types_definition

- rule: SHOW BOT FEATURES
  steps:
  - or:
    - intent: start
    - intent: ask_features
  - action: action_show_features

- rule: UTTER FIND SUBJECT
  steps:
  - intent: find_subject
  - action: utter_find_subject

# misc
# - rule: Respond to ask_what_can_do
#   steps:
#   - intent: ask_what_can_do
#   - action: utter_abilities
#   - intent: tell_me_more     # for this to work, set `restrict_rules: false` for the RulePolicy
#   - action: utter_abilities
#   - intent: tell_me_more
#   - action: utter_abilities